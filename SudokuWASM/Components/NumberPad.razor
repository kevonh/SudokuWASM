@* 
   NumberPad Component - Renders a 3x3 grid of number buttons (1-9)
   Supports both mobile and desktop layouts
*@

<div class="@ContainerClasses">
    <div class="grid grid-cols-3 gap-2">
        @for (int i = 1; i <= 9; i++)
        {
            var number = i;
            var isDisabled = IsNumberDisabled?.Invoke(number) ?? false;
            var buttonClasses = GetButtonClasses(isDisabled);
            
            <button class="@buttonClasses"
                    @onclick="() => OnNumberClick.InvokeAsync(number)"
                    disabled="@isDisabled"
                    title="@GetButtonTitle(number, isDisabled)">
                @number
            </button>
        }
    </div>
</div>

@code {
    /// <summary>
    /// Callback invoked when a number button is clicked
    /// </summary>
    [Parameter] public EventCallback<int> OnNumberClick { get; set; }
    
    /// <summary>
    /// Function to determine if a specific number should be disabled
    /// </summary>
    [Parameter] public Func<int, bool>? IsNumberDisabled { get; set; }
    
    /// <summary>
    /// Determines if this is a mobile layout (affects button sizing)
    /// </summary>
    [Parameter] public bool IsMobile { get; set; } = false;
    
    /// <summary>
    /// Additional CSS classes to apply to the container
    /// </summary>
    [Parameter] public string? AdditionalClasses { get; set; }

    private string ContainerClasses => 
        $"bg-white rounded-lg shadow-lg p-2 {AdditionalClasses}".Trim();

    private string GetButtonClasses(bool isDisabled)
    {
        var baseClasses = IsMobile 
            ? "font-bold py-2 sm:py-3 px-2 sm:px-3 rounded-lg transition-all duration-200 text-lg sm:text-xl touch-manipulation"
            : "font-bold py-4 px-4 rounded-lg transition-all duration-200 text-xl";

        if (isDisabled)
        {
            return $"bg-gray-200 text-gray-400 opacity-50 cursor-not-allowed {baseClasses}";
        }
        
        return $"bg-blue-100 hover:bg-blue-200 active:bg-blue-300 text-blue-700 {baseClasses}";
    }

    private string GetButtonTitle(int number, bool isDisabled)
    {
        return isDisabled 
            ? $"All 9 {number}'s are already placed" 
            : $"Place {number}";
    }
}